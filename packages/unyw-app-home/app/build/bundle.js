var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function c(t){return"function"==typeof t}function l(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}let r,s;function i(t,n){return r||(r=document.createElement("a")),r.href=n,t===r.href}function a(t,n,e,o){return t[1]&&o?function(t,n){for(const e in n)t[e]=n[e];return t}(e.ctx.slice(),t[1](o(n))):e.ctx}function u(t){return null==t?"":t}function d(t,n){t.appendChild(n)}function p(t,n,e){t.insertBefore(n,e||null)}function h(t){t.parentNode.removeChild(t)}function f(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function m(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function v(){return g(" ")}function k(){return g("")}function $(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function b(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function y(t,n){t.value=null==n?"":n}function w(t,n,e,o){t.style.setProperty(n,e,o?"important":"")}function x(t,n,e){t.classList[e?"add":"remove"](n)}function _(t){s=t}function C(){if(!s)throw new Error("Function called outside component initialization");return s}function E(t,n){const e=t.$$.callbacks[n.type];e&&e.slice().forEach((t=>t.call(this,n)))}const z=[],j=[],L=[],O=[],N=Promise.resolve();let T=!1;function D(t){L.push(t)}function U(t){O.push(t)}let A=!1;const P=new Set;function W(){if(!A){A=!0;do{for(let t=0;t<z.length;t+=1){const n=z[t];_(n),I(n.$$)}for(_(null),z.length=0;j.length;)j.pop()();for(let t=0;t<L.length;t+=1){const n=L[t];P.has(n)||(P.add(n),n())}L.length=0}while(z.length);for(;O.length;)O.pop()();T=!1,A=!1,P.clear()}}function I(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(D)}}const K=new Set;let M;function S(){M={r:0,c:[],p:M}}function V(){M.r||o(M.c),M=M.p}function R(t,n){t&&t.i&&(K.delete(t),t.i(n))}function B(t,n,e,o){if(t&&t.o){if(K.has(t))return;K.add(t),M.c.push((()=>{K.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}}function G(t,n){const e=n.token={};function o(t,o,c,l){if(n.token!==e)return;n.resolved=l;let r=n.ctx;void 0!==c&&(r=r.slice(),r[c]=l);const s=t&&(n.current=t)(r);let i=!1;n.block&&(n.blocks?n.blocks.forEach(((t,e)=>{e!==o&&t&&(S(),B(t,1,1,(()=>{n.blocks[e]===t&&(n.blocks[e]=null)})),V())})):n.block.d(1),s.c(),R(s,1),s.m(n.mount(),n.anchor),i=!0),n.block=s,n.blocks&&(n.blocks[o]=s),i&&W()}if((c=t)&&"object"==typeof c&&"function"==typeof c.then){const e=C();if(t.then((t=>{_(e),o(n.then,1,n.value,t),_(null)}),(t=>{if(_(e),o(n.catch,2,n.error,t),_(null),!n.hasCatch)throw t})),n.current!==n.pending)return o(n.pending,0),!0}else{if(n.current!==n.then)return o(n.then,1,n.value,t),!0;n.resolved=t}var c}function H(t,n,e){const o=n.slice(),{resolved:c}=t;t.current===t.then&&(o[t.value]=c),t.current===t.catch&&(o[t.error]=c),t.block.p(o,e)}function q(t,n,e){const o=t.$$.props[n];void 0!==o&&(t.$$.bound[o]=e,e(t.$$.ctx[o]))}function Y(t){t&&t.c()}function F(t,e,l,r){const{fragment:s,on_mount:i,on_destroy:a,after_update:u}=t.$$;s&&s.m(e,l),r||D((()=>{const e=i.map(n).filter(c);a?a.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(D)}function J(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function Q(t,n){-1===t.$$.dirty[0]&&(z.push(t),T||(T=!0,N.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function X(n,c,l,r,i,a,u,d=[-1]){const p=s;_(n);const f=n.$$={fragment:null,ctx:null,props:a,update:t,not_equal:i,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:c.context||[]),callbacks:e(),dirty:d,skip_bound:!1,root:c.target||p.$$.root};u&&u(f.root);let m=!1;if(f.ctx=l?l(n,c.props||{},((t,e,...o)=>{const c=o.length?o[0]:e;return f.ctx&&i(f.ctx[t],f.ctx[t]=c)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](c),m&&Q(n,t)),e})):[],f.update(),m=!0,o(f.before_update),f.fragment=!!r&&r(f.ctx),c.target){if(c.hydrate){const t=function(t){return Array.from(t.childNodes)}(c.target);f.fragment&&f.fragment.l(t),t.forEach(h)}else f.fragment&&f.fragment.c();c.intro&&R(n.$$.fragment),F(n,c.target,c.anchor,c.customElement),W()}_(p)}class Z{$destroy(){J(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function tt(t,n,e){const o=t.slice();return o[3]=n[e],o}function nt(t){let n,e,o,c,l,r,s,i,a,f=t[1][t[3]].label+"";function k(){return t[2](t[3])}return{c(){n=m("div"),e=m("i"),c=v(),l=m("p"),r=g(f),s=v(),b(e,"class",o=u(t[1][t[3]].icon)+" svelte-zd2vxj"),b(l,"class","svelte-zd2vxj"),b(n,"class","svelte-zd2vxj"),x(n,"active",t[3]==t[0])},m(t,o){p(t,n,o),d(n,e),d(n,c),d(n,l),d(l,r),d(n,s),i||(a=$(n,"click",k),i=!0)},p(c,l){t=c,2&l&&o!==(o=u(t[1][t[3]].icon)+" svelte-zd2vxj")&&b(e,"class",o),2&l&&f!==(f=t[1][t[3]].label+"")&&function(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}(r,f),3&l&&x(n,"active",t[3]==t[0])},d(t){t&&h(n),i=!1,a()}}}function et(n){let e,o,c=Object.keys(n[1]),l=[];for(let t=0;t<c.length;t+=1)l[t]=nt(tt(n,c,t));return{c(){e=m("div"),o=m("div");for(let t=0;t<l.length;t+=1)l[t].c();b(o,"class","container svelte-zd2vxj"),b(e,"class","unywui-bottombar svelte-zd2vxj")},m(t,n){p(t,e,n),d(e,o);for(let t=0;t<l.length;t+=1)l[t].m(o,null)},p(t,[n]){if(3&n){let e;for(c=Object.keys(t[1]),e=0;e<c.length;e+=1){const r=tt(t,c,e);l[e]?l[e].p(r,n):(l[e]=nt(r),l[e].c(),l[e].m(o,null))}for(;e<l.length;e+=1)l[e].d(1);l.length=c.length}},i:t,o:t,d(t){t&&h(e),f(l,t)}}}function ot(t,n,e){let{tabs:o={}}=n,{active:c=""}=n;return t.$$set=t=>{"tabs"in t&&e(1,o=t.tabs),"active"in t&&e(0,c=t.active)},[c,o,t=>e(0,c=t)]}class ct extends Z{constructor(t){super(),X(this,t,ot,et,l,{tabs:1,active:0})}}const lt=window.__UNYW_PRIVATE_IP||"localhost";let rt=null;const st=async(t="",n={})=>(await fetch(t,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(n)})).json(),it=async()=>(await fetch("/UNYW_TOKEN_API.json").then((t=>t.json()))).token,at=t=>new Promise((n=>setTimeout(n,t)));var ut=async()=>{for(;;){try{return null==rt&&(rt=await(async()=>{const t="localhost"!=lt?"debugapi":await it(),n={},e=await st(`http://${lt}:12080/unyw/info?token=${t}`);return Object.entries(e.api).forEach((([e,o])=>{n[e]={},o.forEach((o=>{n[e][o]=async n=>st(`http://${lt}:12080/${e}/${o}?token=${t}`,n)}))})),n.unyw.info=async()=>e,n})()),rt}catch(t){console.log("error")}await at(100)}};function dt(t){t[9]=t[12].vnc.token,t[10]=t[12].vnc.width,t[11]=t[12].vnc.height}function pt(n){let e;return{c(){e=m("p"),e.textContent="Error"},m(t,n){p(t,e,n)},p:t,d(t){t&&h(e)}}}function ht(t){let n,e;return dt(t),{c(){n=m("iframe"),b(n,"id","lc-layout-vncviewer"),b(n,"title","vncviewer"),b(n,"srcdoc",e=`\n    <html>\n    <${vt} src='./novnc/novnc.min.js'></${vt}>\n    <style> \n      body { width:${t[10]}px; height:${t[11]}px; }\n      body * { overflow: hidden !important;  background-color: ${t[0]} !important;}\n      body > canvas { background-color: transparent !important;}\n    </style>\n    <body style='overflow: hidden; padding: 0; margin:0; background-color: ${t[0]};'>\n      <${vt}>\n        window.onload = function(){\n          window.vncConnection = new noVNC(\n              document.body,\n              'ws://${t[3]}:12081/websockify',\n              {repeaterID: '',  shared: true,  credentials: { password: '${t[9]}' }, }\n          )\n\n          document.body.addEventListener('keydown',  (e) =>\tvncConnection._keyboard._handleKeyDown(e)  )\n          document.body.addEventListener('keyup',    (e) => vncConnection._keyboard._handleKeyUp(e)    )\n          document.body.addEventListener('keypress', (e) => vncConnection._keyboard._handleKeyPress(e) )\n          vncConnection.scaleViewport = true\n          vncConnection.addEventListener('disconnect', () => setTimeout( () => location.reload(), 500));\n          vncConnection.addEventListener('credentialsrequired', () => vncConnection.sendCredentials({ password: '${t[9]}' }));\n        }\n      </${vt}>\n    </html> `),b(n,"class","svelte-zuad0b")},m(e,o){p(e,n,o),t[6](n)},p(t,o){dt(t),1&o&&e!==(e=`\n    <html>\n    <${vt} src='./novnc/novnc.min.js'></${vt}>\n    <style> \n      body { width:${t[10]}px; height:${t[11]}px; }\n      body * { overflow: hidden !important;  background-color: ${t[0]} !important;}\n      body > canvas { background-color: transparent !important;}\n    </style>\n    <body style='overflow: hidden; padding: 0; margin:0; background-color: ${t[0]};'>\n      <${vt}>\n        window.onload = function(){\n          window.vncConnection = new noVNC(\n              document.body,\n              'ws://${t[3]}:12081/websockify',\n              {repeaterID: '',  shared: true,  credentials: { password: '${t[9]}' }, }\n          )\n\n          document.body.addEventListener('keydown',  (e) =>\tvncConnection._keyboard._handleKeyDown(e)  )\n          document.body.addEventListener('keyup',    (e) => vncConnection._keyboard._handleKeyUp(e)    )\n          document.body.addEventListener('keypress', (e) => vncConnection._keyboard._handleKeyPress(e) )\n          vncConnection.scaleViewport = true\n          vncConnection.addEventListener('disconnect', () => setTimeout( () => location.reload(), 500));\n          vncConnection.addEventListener('credentialsrequired', () => vncConnection.sendCredentials({ password: '${t[9]}' }));\n        }\n      </${vt}>\n    </html> `)&&b(n,"srcdoc",e)},d(e){e&&h(n),t[6](null)}}}function ft(n){let e;return{c(){e=m("span"),w(e,"display","none")},m(t,n){p(t,e,n)},p:t,d(t){t&&h(e)}}}function mt(n){let e,o={ctx:n,current:null,token:null,hasCatch:!0,pending:ft,then:ht,catch:pt,value:12,error:13};return G(n[4],o),{c(){e=m("div"),o.block.c(),b(e,"class","svelte-zuad0b")},m(t,c){p(t,e,c),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=null,n[7](e)},p(t,[e]){H(o,n=t,e)},i:t,o:t,d(t){t&&h(e),o.block.d(),o.token=null,o=null,n[7](null)}}}let gt;window.sendKeyVNC=function(...t){gt.contentWindow.vncConnection.sendKey(...t)};const vt="script";function kt(t,n,e){let{background:o="#fff"}=n,{socket:c}=n;const l=window.__UNYW_PRIVATE_IP||"localhost";let r,s,i=ut().then((t=>t.unyw.info()));const a=async()=>{if(!r)return null;const{process:t}=await ut();return await t.screen({socket:c,width:r.clientWidth,height:r.clientHeight})};var u;return u=async()=>{new ResizeObserver((t=>{t.forEach((()=>a()))})).observe(r)},C().$$.on_mount.push(u),t.$$set=t=>{"background"in t&&e(0,o=t.background),"socket"in t&&e(5,c=t.socket)},t.$$.update=()=>{2&t.$$.dirty&&null!=r&&a(),4&t.$$.dirty&&null!=s&&(gt=s)},[o,r,s,l,i,c,function(t){j[t?"unshift":"push"]((()=>{s=t,e(2,s)}))},function(t){j[t?"unshift":"push"]((()=>{r=t,e(1,r)}))}]}class $t extends Z{constructor(t){super(),X(this,t,kt,mt,l,{background:0,socket:5})}}function bt(t){let n,e,c,l,r,s,i;const u=t[2].default,f=function(t,n,e,o){if(t){const c=a(t,n,e,o);return t[0](c)}}(u,t,t[1],null);return{c(){n=m("label"),e=m("input"),c=v(),l=m("span"),f&&f.c(),b(e,"type","checkbox"),b(e,"class","svelte-14b82ez"),b(l,"class","svelte-14b82ez"),b(n,"class","pure-material-checkbox svelte-14b82ez")},m(o,a){p(o,n,a),d(n,e),e.checked=t[0],d(n,c),d(n,l),f&&f.m(l,null),r=!0,s||(i=[$(e,"change",t[4]),$(e,"change",t[5]),$(n,"click",t[3])],s=!0)},p(t,[n]){1&n&&(e.checked=t[0]),f&&f.p&&(!r||2&n)&&function(t,n,e,o,c,l){if(c){const r=a(n,e,o,l);t.p(r,c)}}(f,u,t,t[1],r?function(t,n,e,o){if(t[2]&&o){const c=t[2](o(e));if(void 0===n.dirty)return c;if("object"==typeof c){const t=[],e=Math.max(n.dirty.length,c.length);for(let o=0;o<e;o+=1)t[o]=n.dirty[o]|c[o];return t}return n.dirty|c}return n.dirty}(u,t[1],n,null):function(t){if(t.ctx.length>32){const n=[],e=t.ctx.length/32;for(let t=0;t<e;t++)n[t]=-1;return n}return-1}(t[1]),null)},i(t){r||(R(f,t),r=!0)},o(t){B(f,t),r=!1},d(t){t&&h(n),f&&f.d(t),s=!1,o(i)}}}function yt(t,n,e){let{$$slots:o={},$$scope:c}=n,{checked:l=!1}=n;return t.$$set=t=>{"checked"in t&&e(0,l=t.checked),"$$scope"in t&&e(1,c=t.$$scope)},[l,c,o,function(n){E.call(this,t,n)},function(n){E.call(this,t,n)},function(){l=this.checked,e(0,l)}]}class wt extends Z{constructor(t){super(),X(this,t,yt,bt,l,{checked:0})}}function xt(t){t[43]=t[44].tokens}function _t(t,n,e){const o=t.slice();return o[45]=n[e][0],o[44]=n[e][1],o}function Ct(t,n,e){const o=t.slice();return o[36]=n[e],o}function Et(t,n,e){const o=t.slice();return o[30]=n[e],o}function zt(t,n,e){const o=t.slice();return o[30]=n[e],o}function jt(t,n,e){const o=t.slice();return o[30]=n[e],o}function Lt(t){let n,e,o,c,l,r,s,i,a=t[1]&&Nt(t);const u=[It,Wt,Pt,At],f=[];function g(t,n){return"apps"===t[0]?0:"add"===t[0]?1:"logs"===t[0]?2:"settings"===t[0]?3:-1}function k(n){t[28](n)}~(o=g(t))&&(c=f[o]=u[o](t));let $={tabs:{apps:{icon:"zmdi zmdi-widgets",label:"Apps"},add:{icon:"zmdi zmdi-download",label:"Add app"},logs:{icon:"zmdi zmdi-memory",label:"Logs"},settings:{icon:"zmdi zmdi-settings",label:"Settings"}}};return void 0!==t[0]&&($.active=t[0]),r=new ct({props:$}),j.push((()=>q(r,"active",k))),{c(){a&&a.c(),n=v(),e=m("main"),c&&c.c(),l=v(),Y(r.$$.fragment),b(e,"class","svelte-17stt69")},m(t,c){a&&a.m(t,c),p(t,n,c),p(t,e,c),~o&&f[o].m(e,null),d(e,l),F(r,e,null),i=!0},p(t,i){t[1]?a?a.p(t,i):(a=Nt(t),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null);let d=o;o=g(t),o===d?~o&&f[o].p(t,i):(c&&(S(),B(f[d],1,1,(()=>{f[d]=null})),V()),~o?(c=f[o],c?c.p(t,i):(c=f[o]=u[o](t),c.c()),R(c,1),c.m(e,l)):c=null);const p={};!s&&1&i[0]&&(s=!0,p.active=t[0],U((()=>s=!1))),r.$set(p)},i(t){i||(R(c),R(r.$$.fragment,t),i=!0)},o(t){B(c),B(r.$$.fragment,t),i=!1},d(t){a&&a.d(t),t&&h(n),t&&h(e),~o&&f[o].d(),J(r)}}}function Ot(n){let e,o,c,l,r={ctx:n,current:null,token:null,hasCatch:!1,pending:rn,then:cn,catch:on,value:29};return G(ut().then(an).then(n[10]),r),{c(){e=m("main"),o=m("div"),c=m("h1"),c.textContent="Open with...",l=v(),r.block.c(),b(o,"class","page svelte-17stt69"),b(e,"class","svelte-17stt69")},m(t,n){p(t,e,n),d(e,o),d(o,c),d(o,l),r.block.m(o,r.anchor=null),r.mount=()=>o,r.anchor=null},p(t,e){H(r,n=t,e)},i:t,o:t,d(t){t&&h(e),r.block.d(),r.token=null,r=null}}}function Nt(t){let n,e,o,c,l;function r(t,n){return"error-apk-running"==t[1]?Ut:"edit-repos"==t[1]?Dt:"add-key"==t[1]?Tt:void 0}let s=r(t),i=s&&s(t);return{c(){n=m("div"),e=v(),o=m("div"),i&&i.c(),b(n,"class","dialog-mask svelte-17stt69"),b(o,"class","dialog svelte-17stt69")},m(r,s){p(r,n,s),p(r,e,s),p(r,o,s),i&&i.m(o,null),c||(l=$(n,"click",t[12]),c=!0)},p(t,n){s===(s=r(t))&&i?i.p(t,n):(i&&i.d(1),i=s&&s(t),i&&(i.c(),i.m(o,null)))},d(t){t&&h(n),t&&h(e),t&&h(o),i&&i.d(),c=!1,l()}}}function Tt(t){let n,e,c,l,r,s,i,a,u,f,g,k;return{c(){n=m("h3"),n.textContent="Add key",e=v(),c=m("div"),l=m("p"),l.textContent="Enter key url",r=v(),s=m("input"),i=v(),a=m("button"),a.textContent="cancel",u=v(),f=m("button"),f.textContent="ok",b(s,"type","text"),w(s,"width","100%"),w(s,"text-align","left"),b(a,"class","svelte-17stt69"),b(f,"class","ok svelte-17stt69")},m(o,h){p(o,n,h),p(o,e,h),p(o,c,h),d(c,l),d(c,r),d(c,s),y(s,t[3]),p(o,i,h),p(o,a,h),p(o,u,h),p(o,f,h),g||(k=[$(s,"input",t[17]),$(a,"click",t[18]),$(f,"click",t[19])],g=!0)},p(t,n){8&n[0]&&s.value!==t[3]&&y(s,t[3])},d(t){t&&h(n),t&&h(e),t&&h(c),t&&h(i),t&&h(a),t&&h(u),t&&h(f),g=!1,o(k)}}}function Dt(t){let n,e,c,l,r,s,i,a,u,f;return{c(){n=m("h3"),n.textContent="Edit repos",e=v(),c=m("div"),l=m("textarea"),r=v(),s=m("button"),s.textContent="cancel",i=v(),a=m("button"),a.textContent="ok",w(l,"width","100%"),w(l,"min-height","120px"),w(l,"text-align","left"),b(s,"class","svelte-17stt69"),b(a,"class","ok svelte-17stt69")},m(o,h){p(o,n,h),p(o,e,h),p(o,c,h),d(c,l),y(l,t[2]),p(o,r,h),p(o,s,h),p(o,i,h),p(o,a,h),u||(f=[$(l,"input",t[14]),$(s,"click",t[15]),$(a,"click",t[16])],u=!0)},p(t,n){4&n[0]&&y(l,t[2])},d(t){t&&h(n),t&&h(e),t&&h(c),t&&h(r),t&&h(s),t&&h(i),t&&h(a),u=!1,o(f)}}}function Ut(n){let e,o,c,l,r,s,i;return{c(){e=m("h3"),e.textContent="Error",o=v(),c=m("p"),c.textContent="Another installation process is already running. Please wait.",l=v(),r=m("button"),r.textContent="ok",b(r,"class","ok svelte-17stt69")},m(t,a){p(t,e,a),p(t,o,a),p(t,c,a),p(t,l,a),p(t,r,a),s||(i=$(r,"click",n[13]),s=!0)},p:t,d(t){t&&h(e),t&&h(o),t&&h(c),t&&h(l),t&&h(r),s=!1,i()}}}function At(t){let n,e,o,c,l,r,s,i,a,u,f,g,k,$,y,x;function _(n){t[26](n)}let C={$$slots:{default:[Kt]},$$scope:{ctx:t}};function E(n){t[27](n)}void 0!==t[4]&&(C.checked=t[4]),l=new wt({props:C}),j.push((()=>q(l,"checked",_))),l.$on("click",t[8]);let z={$$slots:{default:[Mt]},$$scope:{ctx:t}};void 0!==t[5]&&(z.checked=t[5]),a=new wt({props:z}),j.push((()=>q(a,"checked",E))),a.$on("click",t[9]);let L={ctx:t,current:null,token:null,hasCatch:!1,pending:Bt,then:Vt,catch:St,value:44};return G(ut().then(fn),L),{c(){n=m("div"),e=m("h1"),e.textContent="Settings",o=v(),c=m("div"),Y(l.$$.fragment),s=v(),i=m("div"),Y(a.$$.fragment),f=v(),g=m("p"),g.textContent="Work in progress :)",k=v(),$=m("h2"),$.textContent="Tokens",y=v(),L.block.c(),b(e,"class","svelte-17stt69"),w(c,"margin","10px 0"),w(i,"margin-bottom","25px"),b(g,"class","svelte-17stt69"),b($,"class","svelte-17stt69"),b(n,"class","page page-settings svelte-17stt69")},m(t,r){p(t,n,r),d(n,e),d(n,o),d(n,c),F(l,c,null),d(n,s),d(n,i),F(a,i,null),d(n,f),d(n,g),d(n,k),d(n,$),d(n,y),L.block.m(n,L.anchor=null),L.mount=()=>n,L.anchor=null,x=!0},p(n,e){t=n;const o={};131072&e[1]&&(o.$$scope={dirty:e,ctx:t}),!r&&16&e[0]&&(r=!0,o.checked=t[4],U((()=>r=!1))),l.$set(o);const c={};131072&e[1]&&(c.$$scope={dirty:e,ctx:t}),!u&&32&e[0]&&(u=!0,c.checked=t[5],U((()=>u=!1))),a.$set(c),H(L,t,e)},i(t){x||(R(l.$$.fragment,t),R(a.$$.fragment,t),x=!0)},o(t){B(l.$$.fragment,t),B(a.$$.fragment,t),x=!1},d(t){t&&h(n),J(l),J(a),L.block.d(),L.token=null,L=null}}}function Pt(n){let e,o,c,l,r,s;return r=new $t({props:{socket:"home-apk-process"}}),{c(){e=m("div"),o=m("select"),c=m("option"),c.textContent="apk process",l=v(),Y(r.$$.fragment),c.__value="",c.value=c.__value,b(e,"class","page page-logs svelte-17stt69")},m(t,n){p(t,e,n),d(e,o),d(o,c),d(e,l),F(r,e,null),s=!0},p:t,i(t){s||(R(r.$$.fragment,t),s=!0)},o(t){B(r.$$.fragment,t),s=!1},d(t){t&&h(e),J(r)}}}function Wt(n){let e,c,l,r,s,i,a,u,f,g={ctx:n,current:null,token:null,hasCatch:!1,pending:Xt,then:Ht,catch:Gt,value:35};return G(ut().then(dn).then(pn),g),{c(){e=m("div"),c=m("button"),c.innerHTML='Edit repos <i class="zmdi zmdi-edit"></i>',l=v(),r=m("button"),r.innerHTML='Add key <i class="zmdi zmdi-key"></i>',s=v(),i=m("button"),i.innerHTML='Upgrade all <i class="zmdi zmdi-refresh-sync-alert"></i>',a=v(),g.block.c(),b(c,"class","svelte-17stt69"),b(r,"class","svelte-17stt69"),b(i,"class","svelte-17stt69"),b(e,"class","page page-add svelte-17stt69"),b(e,"id","addid")},m(t,o){p(t,e,o),d(e,c),d(e,l),d(e,r),d(e,s),d(e,i),d(e,a),g.block.m(e,g.anchor=null),g.mount=()=>e,g.anchor=null,u||(f=[$(c,"click",n[22]),$(r,"click",n[23]),$(i,"click",n[24])],u=!0)},p(t,e){H(g,n=t,e)},i:t,o:t,d(t){t&&h(e),g.block.d(),g.token=null,g=null,u=!1,o(f)}}}function It(n){let e,o={ctx:n,current:null,token:null,hasCatch:!1,pending:en,then:tn,catch:Zt,value:29};return G(ut().then(un).then(n[20]),o),{c(){e=m("div"),o.block.c(),b(e,"class","page page-apps svelte-17stt69")},m(t,n){p(t,e,n),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=null},p(t,e){H(o,n=t,e)},i:t,o:t,d(t){t&&h(e),o.block.d(),o.token=null,o=null}}}function Kt(t){let n;return{c(){n=g("Allow untrusted")},m(t,e){p(t,n,e)},d(t){t&&h(n)}}}function Mt(t){let n;return{c(){n=g("Debug mode")},m(t,e){p(t,n,e)},d(t){t&&h(n)}}}function St(n){return{c:t,m:t,p:t,d:t}}function Vt(t){let n;xt(t);let e=Object.entries(t[43]),o=[];for(let n=0;n<e.length;n+=1)o[n]=Rt(_t(t,e,n));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();n=k()},m(t,e){for(let n=0;n<o.length;n+=1)o[n].m(t,e);p(t,n,e)},p(t,c){if(xt(t),0&c){let l;for(e=Object.entries(t[43]),l=0;l<e.length;l+=1){const r=_t(t,e,l);o[l]?o[l].p(r,c):(o[l]=Rt(r),o[l].c(),o[l].m(n.parentNode,n))}for(;l<o.length;l+=1)o[l].d(1);o.length=e.length}},d(t){f(o,t),t&&h(n)}}}function Rt(n){let e,o,c,l,r,s=n[45]+"",i=n[44]+"";return{c(){e=m("p"),o=m("b"),c=g(s),l=v(),r=g(i),b(e,"class","svelte-17stt69")},m(t,n){p(t,e,n),d(e,o),d(o,c),d(e,l),d(e,r)},p:t,d(t){t&&h(e)}}}function Bt(n){let e;return{c(){e=m("span"),b(e,"class","hidden svelte-17stt69")},m(t,n){p(t,e,n)},p:t,d(t){t&&h(e)}}}function Gt(n){return{c:t,m:t,p:t,d:t}}function Ht(t){let n,e=t[35],o=[];for(let n=0;n<e.length;n+=1)o[n]=Qt(Ct(t,e,n));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();n=k()},m(t,e){for(let n=0;n<o.length;n+=1)o[n].m(t,e);p(t,n,e)},p(t,c){if(208&c[0]){let l;for(e=t[35],l=0;l<e.length;l+=1){const r=Ct(t,e,l);o[l]?o[l].p(r,c):(o[l]=Qt(r),o[l].c(),o[l].m(n.parentNode,n))}for(;l<o.length;l+=1)o[l].d(1);o.length=e.length}},d(t){f(o,t),t&&h(n)}}}function qt(n){let e,o;return{c(){e=m("span"),o=v(),b(e,"class","hidden svelte-17stt69")},m(t,n){p(t,e,n),p(t,o,n)},p:t,d(t){t&&h(e),t&&h(o)}}}function Yt(t){let n,e,o,c,l,r=t[36]+"",s=t[39].apps,i=[];for(let n=0;n<s.length;n+=1)i[n]=Ft(Et(t,s,n));return{c(){n=m("h3"),e=g(r),o=m("hr"),c=v();for(let t=0;t<i.length;t+=1)i[t].c();l=v(),b(n,"class","svelte-17stt69")},m(t,r){p(t,n,r),d(n,e),p(t,o,r),p(t,c,r);for(let n=0;n<i.length;n+=1)i[n].m(t,r);p(t,l,r)},p(t,n){if(208&n[0]){let e;for(s=t[39].apps,e=0;e<s.length;e+=1){const o=Et(t,s,e);i[e]?i[e].p(o,n):(i[e]=Ft(o),i[e].c(),i[e].m(l.parentNode,l))}for(;e<i.length;e+=1)i[e].d(1);i.length=s.length}},d(t){t&&h(n),t&&h(o),t&&h(c),f(i,t),t&&h(l)}}}function Ft(t){let n,e,o,c,l,r,s,a,u,f,k=t[30].replace("unyw-app-","")+"";function y(){return t[25](t[30])}return{c(){n=m("div"),e=m("div"),o=m("img"),r=v(),s=m("span"),a=g(k),i(o.src,c=`${t[36]}/icons/${t[30]}.png`)||b(o,"src",c),b(o,"alt",l=`Icon for ${t[30]}`),b(o,"height","40px"),b(o,"class","svelte-17stt69"),w(e,"width","60px"),w(e,"height","40px"),w(s,"font-size","1rem"),b(n,"class","app-container svelte-17stt69")},m(t,c){p(t,n,c),d(n,e),d(e,o),d(n,r),d(n,s),d(s,a),u||(f=$(n,"click",y),u=!0)},p(n,e){t=n},d(t){t&&h(n),u=!1,f()}}}function Jt(n){let e,o;return{c(){e=m("span"),o=v(),b(e,"class","hidden svelte-17stt69")},m(t,n){p(t,e,n),p(t,o,n)},p:t,d(t){t&&h(e),t&&h(o)}}}function Qt(t){let n,e={ctx:t,current:null,token:null,hasCatch:!0,pending:Jt,then:Yt,catch:qt,value:39,error:42};return G(fetch(`${t[36]}/manifest.json`).then(hn),e),{c(){n=k(),e.block.c()},m(t,o){p(t,n,o),e.block.m(t,e.anchor=o),e.mount=()=>n.parentNode,e.anchor=n},p(n,o){H(e,t=n,o)},d(t){t&&h(n),e.block.d(t),e.token=null,e=null}}}function Xt(n){let e;return{c(){e=m("span"),b(e,"class","hidden svelte-17stt69")},m(t,n){p(t,e,n)},p:t,d(t){t&&h(e)}}}function Zt(n){return{c:t,m:t,p:t,d:t}}function tn(t){let n,e=t[29],o=[];for(let n=0;n<e.length;n+=1)o[n]=nn(zt(t,e,n));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();n=k()},m(t,e){for(let n=0;n<o.length;n+=1)o[n].m(t,e);p(t,n,e)},p(t,c){if(0&c){let l;for(e=t[29],l=0;l<e.length;l+=1){const r=zt(t,e,l);o[l]?o[l].p(r,c):(o[l]=nn(r),o[l].c(),o[l].m(n.parentNode,n))}for(;l<o.length;l+=1)o[l].d(1);o.length=e.length}},d(t){f(o,t),t&&h(n)}}}function nn(t){let n,e,o,c,l,r,s,a,u,f,k,y=t[30]+"";function x(){return t[21](t[30])}return{c(){n=m("div"),e=m("div"),o=m("img"),r=v(),s=m("span"),a=g(y),u=v(),i(o.src,c=`/apps/${t[30]}/icon.png`)||b(o,"src",c),b(o,"alt",l=`Icon for ${t[30]}`),b(o,"height","40px"),b(o,"class","svelte-17stt69"),w(e,"width","60px"),w(e,"height","40px"),w(s,"font-size","1rem"),b(n,"class","app-container svelte-17stt69")},m(t,c){p(t,n,c),d(n,e),d(e,o),d(n,r),d(n,s),d(s,a),d(n,u),f||(k=$(n,"click",x),f=!0)},p(n,e){t=n},d(t){t&&h(n),f=!1,k()}}}function en(n){let e;return{c(){e=m("span"),b(e,"class","hidden svelte-17stt69")},m(t,n){p(t,e,n)},p:t,d(t){t&&h(e)}}}function on(n){return{c:t,m:t,p:t,d:t}}function cn(t){let n,e=t[29],o=[];for(let n=0;n<e.length;n+=1)o[n]=ln(jt(t,e,n));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();n=k()},m(t,e){for(let n=0;n<o.length;n+=1)o[n].m(t,e);p(t,n,e)},p(t,c){if(0&c){let l;for(e=t[29],l=0;l<e.length;l+=1){const r=jt(t,e,l);o[l]?o[l].p(r,c):(o[l]=ln(r),o[l].c(),o[l].m(n.parentNode,n))}for(;l<o.length;l+=1)o[l].d(1);o.length=e.length}},d(t){f(o,t),t&&h(n)}}}function ln(t){let n,e,o,c,l,r,s,a,u,f,k,y=t[30]+"";function x(){return t[11](t[30])}return{c(){n=m("div"),e=m("div"),o=m("img"),r=v(),s=m("span"),a=g(y),u=v(),i(o.src,c=`/apps/${t[30]}/icon.png`)||b(o,"src",c),b(o,"alt",l=`Icon for ${t[30]}`),b(o,"height","40px"),b(o,"class","svelte-17stt69"),w(e,"width","60px"),w(e,"height","40px"),w(s,"font-size","1rem"),b(n,"class","app-container svelte-17stt69")},m(t,c){p(t,n,c),d(n,e),d(e,o),d(n,r),d(n,s),d(s,a),d(n,u),f||(k=$(n,"click",x),f=!0)},p(n,e){t=n},d(t){t&&h(n),f=!1,k()}}}function rn(n){let e;return{c(){e=m("span"),b(e,"class","hidden svelte-17stt69")},m(t,n){p(t,e,n)},p:t,d(t){t&&h(e)}}}function sn(t){let n,e,o,c;const l=[Ot,Lt],r=[];return n=1,e=r[1]=l[1](t),{c(){e.c(),o=k()},m(t,n){r[1].m(t,n),p(t,o,n),c=!0},p(t,n){e.p(t,n)},i(t){c||(R(e),c=!0)},o(t){B(e),c=!1},d(t){r[1].d(t),t&&h(o)}}}const an=({file:t})=>t.list({path:"/usr/share/unyw/apps"}),un=({file:t})=>t.list({path:"/usr/share/unyw/apps"}),dn=({file:t})=>t.read({path:"/etc/apk/repositories"}),pn=({text:t})=>t.split("\n").filter((t=>t&&!t.startsWith("https://dl-cdn.alpinelinux.org/alpine"))),hn=t=>t.json(),fn=({unyw:t})=>t.info();function mn(t,n,e){let o="apps",c=!1,l="",r="";ut().then((({file:t})=>t.read({path:"/etc/apk/repositories"}))).then((({text:t})=>e(2,l=t)));const s=t=>`'${t.replace("'","'\"'\"'")}'`,i=async t=>{const{file:n,process:l}=await ut(),r=Object.keys((await n.list({path:"/run/unyw"})).list);console.log("mpt",r),r.includes("home-apk-process.lock")?e(1,c="error-apk-running"):(e(0,o="logs"),await n.write({path:"/run/unyw/home-apk-process.lock",text:"lock"}),await l.kill({socket:"home-apk-process"}),await l.screen({socket:"home-apk-process",command:`xterm -e 'date; echo ${t}; ${t}; rm /run/unyw/home-apk-process.lock; read'`}))};let a=!1,u=!1;ut().then((({file:t})=>t.list({path:"/var/unyw/settings"}))).then((({list:t})=>{e(4,a="ALLOW_UNTRUSTED"in t),e(5,u="DEBUG_MODE"in t)}));return[o,c,l,r,a,u,s,i,()=>{ut().then((({process:t})=>t.run({command:a?"rm -f /var/unyw/settings/ALLOW_UNTRUSTED":"mkdir -p  /var/unyw/settings && touch /var/unyw/settings/ALLOW_UNTRUSTED"})))},t=>{t.preventDefault(),ut().then((async({process:t,intent:n})=>{const{authenticated:o}=await n.authenticate({title:"Warning",text:"Enabling/disabling DEBUG_MODE is dangerous"});o&&(e(5,u=!u),t.run({command:u?"mkdir -p  /var/unyw/settings && touch /var/unyw/settings/DEBUG_MODE":"rm -f /var/unyw/settings/DEBUG_MODE"}))}))},({list:t})=>Object.keys(t).filter((t=>"home"!=t)),t=>window.open(`/apps/${t}/index.html`,"_self"),()=>e(1,c=!1),()=>e(1,c=!1),function(){l=this.value,e(2,l)},()=>e(1,c=!1),async()=>{await ut().then((({file:t})=>t.write({path:"/etc/apk/repositories",text:l.trim()}))),e(1,c=!1)},function(){r=this.value,e(3,r)},()=>e(1,c=!1),async()=>{e(1,c=!1),i(`wget -P /etc/apk/keys/ ${s(r)}`)},({list:t})=>Object.keys(t).filter((t=>"home"!=t)),t=>window.open(`/apps/${t}/index.html`,"_self"),()=>e(1,c="edit-repos"),()=>e(1,c="add-key"),()=>i(`apk -U --no-cache ${a?"--allow-untrusted":""} upgrade`),t=>i(`apk add --no-cache ${a?"--allow-untrusted":""} ${s(t)}`),function(t){a=t,e(4,a)},function(t){u=t,e(5,u)},function(t){o=t,e(0,o)}]}return new class extends Z{constructor(t){super(),X(this,t,mn,sn,l,{},null,[-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
