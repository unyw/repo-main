var app=function(){"use strict";function n(){}function e(n){return n()}function t(){return Object.create(null)}function o(n){n.forEach(e)}function c(n){return"function"==typeof n}function r(n,e){return n!=n?e==e:n!==e||n&&"object"==typeof n||"function"==typeof n}function i(n){return null==n?"":n}function l(n,e){n.appendChild(e)}function s(n,e,t){n.insertBefore(e,t||null)}function a(n){n.parentNode.removeChild(n)}function u(n){return document.createElement(n)}function d(n){return document.createTextNode(n)}function p(){return d(" ")}function f(n,e,t,o){return n.addEventListener(e,t,o),()=>n.removeEventListener(e,t,o)}function h(n,e,t){null==t?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function m(n,e){n.value=null==e?"":e}function v(n,e){for(let t=0;t<n.options.length;t+=1){const o=n.options[t];if(o.__value===e)return void(o.selected=!0)}}let y;function $(n){y=n}function k(){if(!y)throw new Error("Function called outside component initialization");return y}const b=[],w=[],g=[],_=[],C=Promise.resolve();let x=!1;function E(n){g.push(n)}let T=!1;const j=new Set;function z(){if(!T){T=!0;do{for(let n=0;n<b.length;n+=1){const e=b[n];$(e),L(e.$$)}for($(null),b.length=0;w.length;)w.pop()();for(let n=0;n<g.length;n+=1){const e=g[n];j.has(e)||(j.add(e),e())}g.length=0}while(b.length);for(;_.length;)_.pop()();x=!1,T=!1,j.clear()}}function L(n){if(null!==n.fragment){n.update(),o(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(E)}}const P=new Set;let A;function K(n,e){n&&n.i&&(P.delete(n),n.i(e))}function N(n,e,t,o){if(n&&n.o){if(P.has(n))return;P.add(n),A.c.push((()=>{P.delete(n),o&&(t&&n.d(1),o())})),n.o(e)}}function D(n,e){const t=e.token={};function c(n,c,r,i){if(e.token!==t)return;e.resolved=i;let l=e.ctx;void 0!==r&&(l=l.slice(),l[r]=i);const s=n&&(e.current=n)(l);let a=!1;e.block&&(e.blocks?e.blocks.forEach(((n,t)=>{t!==c&&n&&(A={r:0,c:[],p:A},N(n,1,1,(()=>{e.blocks[t]===n&&(e.blocks[t]=null)})),A.r||o(A.c),A=A.p)})):e.block.d(1),s.c(),K(s,1),s.m(e.mount(),e.anchor),a=!0),e.block=s,e.blocks&&(e.blocks[c]=s),a&&z()}if((r=n)&&"object"==typeof r&&"function"==typeof r.then){const t=k();if(n.then((n=>{$(t),c(e.then,1,e.value,n),$(null)}),(n=>{if($(t),c(e.catch,2,e.error,n),$(null),!e.hasCatch)throw n})),e.current!==e.pending)return c(e.pending,0),!0}else{if(e.current!==e.then)return c(e.then,1,e.value,n),!0;e.resolved=n}var r}function O(n){n&&n.c()}function W(n,t,r,i){const{fragment:l,on_mount:s,on_destroy:a,after_update:u}=n.$$;l&&l.m(t,r),i||E((()=>{const t=s.map(e).filter(c);a?a.push(...t):o(t),n.$$.on_mount=[]})),u.forEach(E)}function X(n,e){const t=n.$$;null!==t.fragment&&(o(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function I(n,e){-1===n.$$.dirty[0]&&(b.push(n),x||(x=!0,C.then(z)),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function V(e,c,r,i,l,s,u,d=[-1]){const p=y;$(e);const f=e.$$={fragment:null,ctx:null,props:s,update:n,not_equal:l,bound:t(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:c.context||[]),callbacks:t(),dirty:d,skip_bound:!1,root:c.target||p.$$.root};u&&u(f.root);let h=!1;if(f.ctx=r?r(e,c.props||{},((n,t,...o)=>{const c=o.length?o[0]:t;return f.ctx&&l(f.ctx[n],f.ctx[n]=c)&&(!f.skip_bound&&f.bound[n]&&f.bound[n](c),h&&I(e,n)),t})):[],f.update(),h=!0,o(f.before_update),f.fragment=!!i&&i(f.ctx),c.target){if(c.hydrate){const n=function(n){return Array.from(n.childNodes)}(c.target);f.fragment&&f.fragment.l(n),n.forEach(a)}else f.fragment&&f.fragment.c();c.intro&&K(e.$$.fragment),W(e,c.target,c.anchor,c.customElement),z()}$(p)}class U{$destroy(){X(this,1),this.$destroy=n}$on(n,e){const t=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return t.push(e),()=>{const n=t.indexOf(e);-1!==n&&t.splice(n,1)}}$set(n){var e;this.$$set&&(e=n,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}}const R=window.__UNYW_PRIVATE_IP||"localhost";let S=null;const q=async(n="",e={})=>(await fetch(n,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)})).json(),B=async()=>(await fetch("/UNYW_TOKEN_API.json").then((n=>n.json()))).token,Y=n=>new Promise((e=>setTimeout(e,n)));var F=async()=>{for(;;){try{return null==S&&(S=await(async()=>{const n="localhost"!=R?"debugapi":await B(),e={},t=await q(`http://${R}:12080/unyw/info?token=${n}`);return Object.entries(t.api).forEach((([t,o])=>{e[t]={},o.forEach((o=>{e[t][o]=async e=>q(`http://${R}:12080/${t}/${o}?token=${n}`,e)}))})),e.unyw.info=async()=>t,e})()),S}catch(n){console.log("error")}await Y(100)}};function H(n){n[9]=n[12].vnc.token,n[10]=n[12].vnc.width,n[11]=n[12].vnc.height}function J(e){let t;return{c(){t=u("p"),t.textContent="Error"},m(n,e){s(n,t,e)},p:n,d(n){n&&a(t)}}}function M(n){let e,t;return H(n),{c(){e=u("iframe"),h(e,"id","lc-layout-vncviewer"),h(e,"title","vncviewer"),h(e,"srcdoc",t=`\n    <html>\n    <${tn} src='./novnc/novnc.min.js'></${tn}>\n    <style> \n      body { width:${n[10]}px; height:${n[11]}px; }\n      body * { overflow: hidden !important;  background-color: ${n[0]} !important;}\n      body > canvas { background-color: transparent !important;}\n    </style>\n    <body style='overflow: hidden; padding: 0; margin:0; background-color: ${n[0]};'>\n      <${tn}>\n        window.onload = function(){\n          window.vncConnection = new noVNC(\n              document.body,\n              'ws://${n[3]}:12081/websockify',\n              {repeaterID: '',  shared: true,  credentials: { password: '${n[9]}' }, }\n          )\n\n          document.body.addEventListener('keydown',  (e) =>\tvncConnection._keyboard._handleKeyDown(e)  )\n          document.body.addEventListener('keyup',    (e) => vncConnection._keyboard._handleKeyUp(e)    )\n          document.body.addEventListener('keypress', (e) => vncConnection._keyboard._handleKeyPress(e) )\n          vncConnection.scaleViewport = true\n          vncConnection.addEventListener('disconnect', () => setTimeout( () => location.reload(), 500));\n          vncConnection.addEventListener('credentialsrequired', () => vncConnection.sendCredentials({ password: '${n[9]}' }));\n        }\n      </${tn}>\n    </html> `),h(e,"class","svelte-zuad0b")},m(t,o){s(t,e,o),n[6](e)},p(n,o){H(n),1&o&&t!==(t=`\n    <html>\n    <${tn} src='./novnc/novnc.min.js'></${tn}>\n    <style> \n      body { width:${n[10]}px; height:${n[11]}px; }\n      body * { overflow: hidden !important;  background-color: ${n[0]} !important;}\n      body > canvas { background-color: transparent !important;}\n    </style>\n    <body style='overflow: hidden; padding: 0; margin:0; background-color: ${n[0]};'>\n      <${tn}>\n        window.onload = function(){\n          window.vncConnection = new noVNC(\n              document.body,\n              'ws://${n[3]}:12081/websockify',\n              {repeaterID: '',  shared: true,  credentials: { password: '${n[9]}' }, }\n          )\n\n          document.body.addEventListener('keydown',  (e) =>\tvncConnection._keyboard._handleKeyDown(e)  )\n          document.body.addEventListener('keyup',    (e) => vncConnection._keyboard._handleKeyUp(e)    )\n          document.body.addEventListener('keypress', (e) => vncConnection._keyboard._handleKeyPress(e) )\n          vncConnection.scaleViewport = true\n          vncConnection.addEventListener('disconnect', () => setTimeout( () => location.reload(), 500));\n          vncConnection.addEventListener('credentialsrequired', () => vncConnection.sendCredentials({ password: '${n[9]}' }));\n        }\n      </${tn}>\n    </html> `)&&h(e,"srcdoc",t)},d(t){t&&a(e),n[6](null)}}}function G(e){let t;return{c(){var n,e,o;t=u("span"),n="display",e="none",t.style.setProperty(n,e,o?"important":"")},m(n,e){s(n,t,e)},p:n,d(n){n&&a(t)}}}function Q(e){let t,o={ctx:e,current:null,token:null,hasCatch:!0,pending:G,then:M,catch:J,value:12,error:13};return D(e[4],o),{c(){t=u("div"),o.block.c(),h(t,"class","svelte-zuad0b")},m(n,c){s(n,t,c),o.block.m(t,o.anchor=null),o.mount=()=>t,o.anchor=null,e[7](t)},p(n,[t]){!function(n,e,t){const o=e.slice(),{resolved:c}=n;n.current===n.then&&(o[n.value]=c),n.current===n.catch&&(o[n.error]=c),n.block.p(o,t)}(o,e=n,t)},i:n,o:n,d(n){n&&a(t),o.block.d(),o.token=null,o=null,e[7](null)}}}let Z;function nn(...n){Z.contentWindow.vncConnection.sendKey(...n)}window.sendKeyVNC=nn;let en=!0;const tn="script";function on(n,e,t){let{background:o="#fff"}=e,{socket:c}=e;const r=window.__UNYW_PRIVATE_IP||"localhost";let i,l,s=F().then((n=>n.unyw.info()));const a=async()=>{if(!i)return null;const{process:n}=await F();return await n.screen({socket:c,width:i.clientWidth,height:i.clientHeight})};var u;return u=async()=>{new ResizeObserver((n=>{n.forEach((()=>a()))})).observe(i)},k().$$.on_mount.push(u),n.$$set=n=>{"background"in n&&t(0,o=n.background),"socket"in n&&t(5,c=n.socket)},n.$$.update=()=>{2&n.$$.dirty&&null!=i&&a(),4&n.$$.dirty&&null!=l&&(Z=l)},[o,i,l,r,s,c,function(n){w[n?"unshift":"push"]((()=>{l=n,t(2,l)}))},function(n){w[n?"unshift":"push"]((()=>{i=n,t(1,i)}))}]}class cn extends U{constructor(n){super(),V(this,n,on,Q,r,{background:0,socket:5})}}function rn(e){let t,c,r,v,y,$,k,b,w,g,_,C,x,E,T,j,z,L,P,A,K,N,D,O,W;return{c(){t=u("div"),c=u("div"),r=u("p"),r.textContent="TAB",v=p(),y=u("p"),$=d("CTRL"),b=p(),w=u("p"),g=d("ALT"),C=p(),x=u("i"),E=p(),T=u("i"),j=p(),z=u("i"),L=p(),P=u("i"),A=p(),K=u("i"),N=p(),D=u("input"),h(r,"class","svelte-1p86im5"),h(y,"class",k=i(e[10]?"active":"")+" svelte-1p86im5"),h(w,"class",_=i(e[11]?"active":"")+" svelte-1p86im5"),h(x,"class","zmdi zmdi-long-arrow-left svelte-1p86im5"),h(T,"class","zmdi zmdi-long-arrow-up svelte-1p86im5"),h(z,"class","zmdi zmdi-long-arrow-down svelte-1p86im5"),h(P,"class","zmdi zmdi-long-arrow-right svelte-1p86im5"),h(K,"class","zmdi zmdi-keyboard svelte-1p86im5"),h(c,"class","container svelte-1p86im5"),h(D,"type","text"),h(D,"ref","keyboard"),h(D,"autocorrect","off"),h(D,"autocapitalize","none"),h(D,"autocomplete","off"),h(D,"spellcheck","false"),h(D,"class","svelte-1p86im5"),h(t,"class","unywui-bottombar svelte-1p86im5")},m(n,o){s(n,t,o),l(t,c),l(c,r),e[15](r),l(c,v),l(c,y),l(y,$),e[16](y),l(c,b),l(c,w),l(w,g),e[17](w),l(c,C),l(c,x),e[18](x),l(c,E),l(c,T),e[19](T),l(c,j),l(c,z),e[20](z),l(c,L),l(c,P),e[21](P),l(c,A),l(c,K),e[22](K),l(t,N),l(t,D),m(D,e[0]),e[24](D),O||(W=[f(D,"input",e[23]),f(D,"blur",e[14]),f(D,"click",e[12]),f(D,"input",e[25]),f(D,"keyup",e[26]),f(D,"keydown",e[27]),f(D,"keypress",e[28])],O=!0)},p(n,[e]){1024&e&&k!==(k=i(n[10]?"active":"")+" svelte-1p86im5")&&h(y,"class",k),2048&e&&_!==(_=i(n[11]?"active":"")+" svelte-1p86im5")&&h(w,"class",_),1&e&&D.value!==n[0]&&m(D,n[0])},i:n,o:n,d(n){n&&a(t),e[15](null),e[16](null),e[17](null),e[18](null),e[19](null),e[20](null),e[21](null),e[22](null),e[24](null),O=!1,o(W)}}}function ln(n,e,t){let o,c,r,i,l,s,a,u,d,p="",f=!1,h=!1,m=!1;const v=(n,e)=>{const t=e.getBoundingClientRect();return n>t.left&&n<t.right},y=(n,e)=>{e.preventDefault(),function(n,e){const t={keydown:n=>Z.contentWindow.vncConnection._keyboard._handleKeyDown(n),keyup:n=>Z.contentWindow.vncConnection._keyboard._handleKeyUp(n),keypress:n=>Z.contentWindow.vncConnection._keyboard._handleKeyPress(n),input:n=>{if("deleteContentBackward"===n.inputType)return nn(65288,null),void n.preventDefault();nn(n.data.charCodeAt(0),n.data.charCodeAt(0))}};"keydown"===n&&229===e.keyCode&&(en=!0),"input"==n&&(en=!1),"keyup"===n&&229===e.keyCode&&en?nn(65288,null):t[n](e)}(n,e)};return[p,o,c,r,i,l,s,a,u,d,f,h,n=>{if(n.preventDefault(),v(n.clientX,o)&&nn(65289,null),v(n.clientX,c)&&(t(10,f=!f),nn(65507,null,f)),v(n.clientX,r)&&(t(11,h=!h),nn(65513,null,h)),v(n.clientX,i)&&nn(65361,null),v(n.clientX,l)&&nn(65362,null),v(n.clientX,s)&&nn(65364,null),v(n.clientX,a)&&nn(65363,null),v(n.clientX,u)&&m)return d.blur(),void(m=!1);m||(m=!0)},y,()=>m=!1,function(n){w[n?"unshift":"push"]((()=>{o=n,t(1,o)}))},function(n){w[n?"unshift":"push"]((()=>{c=n,t(2,c)}))},function(n){w[n?"unshift":"push"]((()=>{r=n,t(3,r)}))},function(n){w[n?"unshift":"push"]((()=>{i=n,t(4,i)}))},function(n){w[n?"unshift":"push"]((()=>{l=n,t(5,l)}))},function(n){w[n?"unshift":"push"]((()=>{s=n,t(6,s)}))},function(n){w[n?"unshift":"push"]((()=>{a=n,t(7,a)}))},function(n){w[n?"unshift":"push"]((()=>{u=n,t(8,u)}))},function(){p=this.value,t(0,p)},function(n){w[n?"unshift":"push"]((()=>{d=n,t(9,d)}))},n=>y("input",n),n=>y("keyup",n),n=>y("keydown",n),n=>y("keypress",n)]}class sn extends U{constructor(n){super(),V(this,n,ln,rn,r,{})}}function an(n){let e,t,o,c,r,i="error-apk-running"==n[1]&&un(n);return{c(){e=u("div"),t=p(),o=u("div"),i&&i.c(),h(e,"class","dialog-mask svelte-l0jic5"),h(o,"class","dialog svelte-l0jic5")},m(l,a){s(l,e,a),s(l,t,a),s(l,o,a),i&&i.m(o,null),c||(r=f(e,"click",n[2]),c=!0)},p(n,e){"error-apk-running"==n[1]?i?i.p(n,e):(i=un(n),i.c(),i.m(o,null)):i&&(i.d(1),i=null)},d(n){n&&a(e),n&&a(t),n&&a(o),i&&i.d(),c=!1,r()}}}function un(e){let t,o,c,r,i,l,d;return{c(){t=u("h3"),t.textContent="Error",o=p(),c=u("p"),c.textContent="Another installation process is already running. Please wait.",r=p(),i=u("button"),i.textContent="ok",h(i,"class","ok svelte-l0jic5")},m(n,a){s(n,t,a),s(n,o,a),s(n,c,a),s(n,r,a),s(n,i,a),l||(d=f(i,"click",e[3]),l=!0)},p:n,d(n){n&&a(t),n&&a(o),n&&a(c),n&&a(r),n&&a(i),l=!1,d()}}}function dn(n){let e,t,o,c,r,i,d,m,y,$,k,b,w,g,_,C=n[1]&&an(n);return $=new cn({props:{socket:`xterm-app-${n[0]}`}}),b=new sn({}),{c(){C&&C.c(),e=p(),t=u("main"),o=u("select"),c=u("option"),c.textContent="Terminal 1",r=u("option"),r.textContent="Terminal 2",i=u("option"),i.textContent="Terminal 3",d=u("option"),d.textContent="Terminal 4",m=u("option"),m.textContent="Terminal 5",y=p(),O($.$$.fragment),k=p(),O(b.$$.fragment),c.__value="terminal1",c.value=c.__value,r.__value="terminal2",r.value=r.__value,i.__value="terminal3",i.value=i.__value,d.__value="terminal4",d.value=d.__value,m.__value="terminal5",m.value=m.__value,void 0===n[0]&&E((()=>n[4].call(o))),h(t,"class","svelte-l0jic5")},m(a,u){C&&C.m(a,u),s(a,e,u),s(a,t,u),l(t,o),l(o,c),l(o,r),l(o,i),l(o,d),l(o,m),v(o,n[0]),l(t,y),W($,t,null),l(t,k),W(b,t,null),w=!0,g||(_=f(o,"change",n[4]),g=!0)},p(n,[t]){n[1]?C?C.p(n,t):(C=an(n),C.c(),C.m(e.parentNode,e)):C&&(C.d(1),C=null),1&t&&v(o,n[0]);const c={};1&t&&(c.socket=`xterm-app-${n[0]}`),$.$set(c)},i(n){w||(K($.$$.fragment,n),K(b.$$.fragment,n),w=!0)},o(n){N($.$$.fragment,n),N(b.$$.fragment,n),w=!1},d(n){C&&C.d(n),n&&a(e),n&&a(t),X($),X(b),g=!1,_()}}}function pn(n,e,t){let o=!1,c="terminal1";return n.$$.update=()=>{if(1&n.$$.dirty){const n=`xterm-app-${c}`;F().then((({process:e})=>e.screen({socket:n,command:"xterm"})))}},[c,o,()=>t(1,o=!1),()=>t(1,o=!1),function(){c=function(n){const e=n.querySelector(":checked")||n.options[0];return e&&e.__value}(this),t(0,c)}]}return new class extends U{constructor(n){super(),V(this,n,pn,dn,r,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
